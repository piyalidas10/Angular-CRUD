# Angular 19 SSR Hybrid Rendering CRUD application

## Hybrid Rendering
SSR - SEO heavy pages
CSR - dynamic experiences
SSG - static, fast loading pages

### ğŸ’¡ Key Fixes Explained

1. serve:ssr renamed to match Angular CLI convention
```
"serve:ssr": "node dist/angular-crud/server/server.mjs"
```
â†’ This is the correct file path generated by ng build && ng run angular-crud:server.

2. Added serve:ssr:dev
```
"serve:ssr:dev": "ts-node --esm server.ts"
```
â†’ Lets you run your TypeScript-based Express server directly (no build needed) during development.

3. Ensured TypeScript & Node typings match
  - "typescript": "~5.6.2" âœ… (Angular 19 compatible)
  - "@types/node": "^20.x" âœ… (for Node 18+)
  - "ts-node": "^10.9.2" âœ… (supports ESM)

4. Slight bump in dependencies
  - express updated to latest stable (4.21.0)
  - tslib updated to ^2.8.0 (works better with Angular 19 builds)

### NPM scripts

| Command             | Description                       |
| ------------------- | --------------------------------- |
| `npm start`         | Regular dev server (CSR only)     |
| `npm run build:ssr` | Builds for SSR                    |
| `npm run serve:ssr` | Runs Node SSR server              |
| `npm run dev:ssr`   | Live SSR dev mode                 |
| `npm run prerender` | Generates static prerendered HTML |

###
  1ï¸âƒ£ Add "type": "module"

  Angular 19 outputs ES Modules for the SSR server (server.mjs), so Node needs this line at the top level:
  ```
  "type": "module",
  ```

  Otherwise, you might see:
  ```
  SyntaxError: Cannot use import statement outside a module
  ```


  ğŸ§© 3. Verify your file structure

    Check that your important SSR files exist:

    src/
    â”œâ”€â”€ app/
    â”‚   â”œâ”€â”€ app.component.ts
    â”‚   â”œâ”€â”€ app.config.ts
    â”‚   â”œâ”€â”€ app.routes.ts
    â”‚   â”œâ”€â”€ products/
    â”‚       â”œâ”€â”€ home/home.component.ts
    â”‚       â”œâ”€â”€ create/create.component.ts
    â”‚       â”œâ”€â”€ edit/edit.component.ts
    â”œâ”€â”€ main.ts
    â”œâ”€â”€ main.server.ts
    â”œâ”€â”€ app.config.server.ts


    âœ… main.server.ts â€” entry point for server
    âœ… app.config.server.ts â€” merges SSR providers
    âœ… app.routes.ts â€” app routes



### ğŸš€ Run Application

***ğŸ§© 1ï¸âƒ£ Run Backgroud**

Make sure your backend (Node/Express, JSON server, etc.) is actually running on port 3000.

If youâ€™re using JSON Server for mock data, run:
```
npx json-server --watch src/app/json-server/products.json --port 3000
```

Then open this in your browser:
ğŸ‘‰ http://localhost:3000/products

You should see an array of JSON data.
If you see â€œCannot GET /productsâ€, your backend isnâ€™t ready yet.


***ğŸ§© 2ï¸âƒ£ Fix CORS (Cross-Origin Resource Sharing)**

When your Angular app runs at port 4200 or 4000 (SSR), itâ€™s on a different origin than port 3000.

You must allow requests from Angularâ€™s origin in your backend.
```
Example for Express backend:
import express from 'express';
import cors from 'cors';

const app = express();
app.use(cors()); // âœ… enable all origins for testing
app.use(express.json());

app.get('/products', (req, res) => {
  res.json([
    { id: 1, name: 'Phone', price: 1000 },
    { id: 2, name: 'Laptop', price: 2000 }
  ]);
});

app.listen(3000, () => console.log('API running on http://localhost:3000'));
```

------------------------------------------------------------------------------------------------

***ğŸ§© 1ï¸âƒ£ Development (browser only)**
```
npm start
```
Runs ng serve â†’ browser dev mode (no SSR).



***âš™ï¸ 2ï¸âƒ£ Build and run with SSR**
```
npm run build:ssr
npm run serve:ssr
```
After this, youâ€™ll get:

dist/angular-crud/
â”œâ”€â”€ browser/
â”œâ”€â”€ server/
â”‚   â””â”€â”€ server.mjs

ğŸ‘‰ Opens your SSR-rendered app at http://localhost:4000



***ğŸ§± 3ï¸âƒ£ Static prerender (SSG)**
```
npm run prerender
```
Generates static HTML for prerender routes (from app.routes.server.ts).



***âš¡ 4ï¸âƒ£ Live SSR dev mode (optional)**
```
npm run dev:ssr
```
Hot-reloads both client & server bundles in development mode (Angular 19â€™s unified SSR dev server).



### Show COnfig
```
npx tsc --showConfig -p tsconfig.server.json | grep server.ts
```

### Output dist folder will look like:

dist/
â””â”€â”€ angular-crud/
    â”œâ”€â”€ browser/
    â”‚   â”œâ”€â”€ index.html
    â”‚   â”œâ”€â”€ main.js
    â”‚   â””â”€â”€ ...
    â””â”€â”€ server/
        â”œâ”€â”€ main.js
        â”œâ”€â”€ server.mjs
        â””â”€â”€ server.js.map


1. Build the application with the command as ng build. This will generate a dist folder in your directory for both browser and server. 
2. Run the server by using the command: node dist/<your-ssr-aap-name>/server/server.mjs
3. Once you create an Angular SSR project, Angular will create a server.ts which loads the app by using Express.js, and a main.server.ts which functions the same as Angular App Module but for the server.
Ensure all the configuration is correctly set up. 
Specifically, the angular.json file should have the server file configured  build/options as => â€œserverâ€: â€œsrc/main.server.tsâ€,
4. Inside tsconfig.app.json
```
"files": [
    "src/main.ts",
    "src/main.server.ts",
    "src/server.ts"
  ],
```
5. To establish the connection between the backend and frontend in Angular Universal SSR, you need to add provideHttpClient(withFetch()) in your app.config.ts file

    -   app.config.server.ts: Used for server application configuration.
    -   src/main.server.ts: It serves as the server-side rendering logicâ€™s entry point. We can manage the main server application startup with the aid of this file.
    -   src/app/app.server.module.ts: Includes the server-side application module for Angular Universal SSR.
    -   src/server.ts: This file is used by the Express server to render the Angular application on the server-side.